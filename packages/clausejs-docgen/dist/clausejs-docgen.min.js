!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.C=n():e.C=n()}(this,function(){return function(e){function __webpack_require__(r){if(n[r])return n[r].exports;var t=n[r]={i:r,l:!1,exports:{}};return e[r].call(t.exports,t,t.exports,__webpack_require__),t.l=!0,t.exports}var n={};return __webpack_require__.m=e,__webpack_require__.c=n,__webpack_require__.i=function(e){return e},__webpack_require__.d=function(e,n,r){__webpack_require__.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},__webpack_require__.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(n,"a",n),n},__webpack_require__.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=87)}([function(e,n,r){"use strict";function isProblem(e){return e instanceof t}var t=r(2);e.exports=isProblem},function(e,n,r){"use strict";function Clause(e){var n=e.type,r=e.exprs,t=e.opts,a=(e.fragments,e.conformFn),o=e.generateFn;if(this.type=n,t&&(this.opts=t),a&&(this.conform=a),o&&(this.generate=o),!r)throw new Error("Expressions are required when constructing a clause.");this.exprs=r}e.exports=Clause},function(e,n,r){"use strict";function Problem(e,n,r,t){var a=this;if(this.isProblem=!0,4!==arguments.length)throw"Problem arg len err";this.val=e,this.name="Problem",this.failsPredicate=n,this.shortMessage=t,this.subproblems=r,i(this,"message",function(){return _constructMessage(a,0)}),this.toString=function(){return a.message}}function _constructMessage(e,n){var r=e.subproblems,a=e.val,i=e.shortMessage;if(Array.isArray(r)){var s;return 0===r.length?i+"; val: "+o(a,null,2):(s=r.map(function(e){return""+_open(n)+_constructMessage(e,n+1)+_close(n)}),i+", because\n"+_repeatStr(" ",2*n)+" "+s.join(", "))}if("object"===("undefined"==typeof r?"undefined":t(r))){s=[];for(var u in r)r.hasOwnProperty(u)&&s.push("-> "+u+": "+_open(n)+" "+_constructMessage(r[u],n+1)+_close(n));return i+", because\n"+_repeatStr(" ",2*n)+" "+s.join(", ")}}function _repeatStr(e,n){for(var r="",t=0;t<n;t+=1)r+=e;return r}function _open(e){return a[e]}function _close(e){return a[a.length-e-1]}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a="❰❮❬❨❪﹙₍₎﹚❫❩❭❯❱",o=r(20),i=r(69);e.exports=Problem},function(e,n,r){"use strict";function getFunctionName(e){return a(e)?e.__predToString?e.__predToString():t?t(e):e.name:null}var t,a=r(13);if("test"!==function(){}.name){var o=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,i=Function.prototype.toString,s=String.prototype.match,u=String.prototype.replace,c=r(71),l=new RegExp("^["+c+"]*(?:function|class)["+c+"]*\\*?["+c+"]+([\\w\\$]+)["+c+"]*","i");t=function(e){var n=s.call(u.call(i.call(e),o," "),l);return n&&"anonymous"!==n[1]?n[1]:""}}else"anonymous"===(new Function).name&&(t=function(e){return e.name&&"anonymous"!==e.name?e.name:""});e.exports=getFunctionName},function(e,n,r){"use strict";function toObject(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function shouldUseNative(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var n={},r=0;r<10;r++)n["_"+String.fromCharCode(r)]=r;var t=Object.getOwnPropertyNames(n).map(function(e){return n[e]});if("0123456789"!==t.join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}var t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=shouldUseNative()?Object.assign:function(e,n){for(var r,i,s=toObject(e),u=1;u<arguments.length;u++){r=Object(arguments[u]);for(var c in r)a.call(r,c)&&(s[c]=r[c]);if(t){i=t(r);for(var l=0;l<i.length;l++)o.call(r,i[l])&&(s[i[l]]=r[i[l]])}}return s}},function(e,n,r){"use strict";var t=r(1),a=r(22),o=a(t);e.exports=o},function(e,n,r){"use strict";var t=r(9);e.exports=function(e){if(!e)throw console.error(e),"!";if(e.clause)return e.clause;if(e.pred)return t(e.pred);throw console.error("unsupported:",e),"Not implemented"}},function(e,n,r){"use strict";function isString(e){return null!==e&&void 0!==e&&e.constructor===String}e.exports=isString},function(e,n,r){"use strict";function _defineProperty(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function _labelled(){var e=Array.prototype.slice.call(arguments);return{expressions:{withLabels:e.map(function(e){var n=t(e,3),r=n[0],a=n[1],o=n[2];return{name:r,expr:_defineProperty({},a,o)}})}}}function _unlabelled(){var e=Array.prototype.slice.call(arguments);return{expressions:{withoutLabels:e.map(function(e){var n=t(e,2),r=n[0],a=n[1];return _defineProperty({},r,a)})}}}function andOp(e){var n=new o({type:"AND",exprs:[],fragments:e,opts:{conformedExprs:e}});return n.conform=function(e){return y(n,e,{conform:!0})},n}function noDupelicateLabels(e){var n=e.expressions.withLabels;if(n)for(var r=[],t=0;t<n.length;t+=1){var a=n[t].name;if(r.indexOf(a)>=0)throw new Error("Duplicate label detected: "+a);r.push(a)}return!0}function genMultiArgOp(e){return f(e,function(n){var r,t=n.expressions,i=t.withLabels,s=t.withoutLabels,c=n.options;if(i){r=i;var l=r.map(function(e){var n=e.expr,r=u(n);return a({},e,{expr:r,clause:void 0,pred:void 0,clauseRef:void 0,delayedClause:void 0})}),f=a({},c,{named:!0}),p=new o({type:e,exprs:l,opts:f});return p.conform=function(e){return y(p,e,{conform:!0})},p}if(s){r=s,l=r.map(function(e){var n;if(e.clause)return n=e.clause,a({},e,{expr:n,clause:void 0});if(e.pred)return n=v(e.pred),a({},e,{expr:n,pred:void 0});if(e.clauseRef)return n=e.clauseRef,a({},e,{expr:n,clauseRef:void 0});if(e.delayedClause)return n=e.delayedClause,a({},e,{expr:n,delayedClause:void 0});throw console.error(e),"!"});var d=a({},c,{named:!1});return p=new o({type:e,exprs:l,opts:d}),p.conform=function(e){return y(p,e,{conform:!0})},p}return p=new o({type:e,exprs:[],opts:{}}),p.conform=function(e){return y(p,e,{conform:!0})},p})}function genSingleArgOp(e){return f(e,function(n){var r,t=n.expr,i=n.opts;if(t.clause)r=t.clause;else if(t.pred)r=v(t.pred);else if(t.clauseRef)r=t.clauseRef;else{if(!t.delayedClause)throw console.error(t),"internal err";r=t.delayedClause}var s=v(r),u=new o({type:e,exprs:[s],opts:a({},i,{enclosedClause:s})});return u.conform=function(e){return y(u,e,{conform:!0})},u})}function isPropName(e){return h(e)}function mapOfOp(e){if(c(e))throw e;var n=e.keyExpression,r=e.valExpression,t=new o({type:U,exprs:[],opts:{keyExpression:n,valExpression:r}});return t.conform=function(e){return y(t,e,{conform:!0})},t}function shapeOp(e){if(c(e))throw e;var n=new o({type:z,exprs:[],fragments:[],opts:{conformedArgs:e}});return n.conform=function(e){return y(n,e,{conform:!0})},n}var t=function(){function sliceIterator(e,n){var r=[],t=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done)&&(r.push(i.value),!n||r.length!==n);t=!0);}catch(e){a=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(a)throw o}}return r}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return sliceIterator(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=r(4),o=r(1),i=r(5),s=r(10),u=r(6),c=r(0),l=r(42),f=r(16),p=r(15),d=r(26),m=r(48),v=r(9),g=r(21),y=r(17),_=r(24),h=r(7),b=r(39),x=r(38),O=v(i),w=v(l),P=genMultiArgOp(m.CAT),E=genMultiArgOp(m.OR),C=genSingleArgOp(m.Z_OR_M),S=genSingleArgOp(m.O_OR_M),A=genSingleArgOp(m.Z_OR_O),R=genSingleArgOp(m.COLL_OF),N=v(i),k=v(p),F=v(d),M=v(s),j=E(_labelled(["clause","clause",N],["pred","clause",M])),T=P(_labelled(["name","clause",w],["comment","clause",A({expr:{pred:h}})],["expr","clause",j])),q=P(_labelled(["expressions","clause",E(_labelled(["withLabels","clause",E(_unlabelled(["clause",C({expr:{clause:T}})],["clause",R({expr:{clause:T}})]))],["withoutLabels","clause",C({expr:{clause:j}})]))],["options","clause",A({expr:{pred:x}})])),D=andOp([{clause:q},{pred:noDupelicateLabels}]),L=g({args:S({expr:{clause:j}}),ret:i}),I={args:D,ret:O},W=function(e){return{args:P(_labelled(["expr","clause",j],["opts","clause",A({expr:e})])),ret:O}},z="SHAPE",U="MAP_OF",G=mapOfOp({keyExpression:{clause:v(h)},valExpression:{clause:E(_labelled(["valExpressionOnly","clause",j],["keyValExprPair","clause",P(_labelled(["keyExpression","clause",j],["valExpression","clause",j]))]))}}),V=C({expr:{pred:isPropName}}),Z=E(_labelled(["keyList","clause",V],["fieldDefs","clause",G])),K=shapeOp({shapeArgs:{optionalFields:{opt:{fieldDefs:{requiredFields:{keyValExprPair:{keyExpression:{pred:b("req","required")},valExpression:{clause:Z}}},optionalFields:{keyValExprPair:{keyExpression:{pred:b("opt","optional")},valExpression:{clause:Z}}}}}}}}),H=g({args:P(_labelled(["keyExpression","clause",j],["valExpression","clause",j])),ret:i}),Q=(shapeOp({shapeArgs:{optionalFields:{opt:{fieldDefs:{requiredFields:{keyValExprPair:{keyExpression:{pred:b("req","required")},valExpression:{clause:Z}}},optionalFields:{keyValExprPair:{keyExpression:{pred:b("opt","optional")},valExpression:{clause:Z}}}}}}}}),g({args:P(_labelled(["shapeArgs","clause",K])),ret:i})),Y=Q.instrumentConformed(shapeOp),$=H.instrumentConformed(mapOfOp),B=g(W({pred:_})),J=B.instrumentConformed(R),X=g(I),ee=g(I),ne=g(W({pred:_})),re=g(W({pred:_})),te=g(W({pred:_})),ae=L.instrumentConformed(andOp),oe={cat:X.instrumentConformed(P),or:ee.instrumentConformed(E),zeroOrMore:ne.instrumentConformed(C),zeroOrOne:te.instrumentConformed(A),oneOrMore:re.instrumentConformed(S),ExprClause:j,ClauseClause:N,PredClause:M,DelayedClauseClause:F,ClauseRefClause:k,CatFnClause:X,AndFnClause:L,OrFnClause:ee,ZeroOrMoreFnClause:ne,OneOrMoreFnClause:re,ZeroOrOneFnClause:te,CollOfClause:B,collOf:J,and:ae,shape:Y,keys:Y,mapOf:$,ShapeFnClause:Q,MapOfFnClause:H};oe.alt=oe.or,oe["*"]=oe.zeroOrMore,oe["+"]=oe.oneOrMore,oe["?"]=oe.zeroOrOne,e.exports=oe},function(e,n,r){"use strict";function coerceIntoClause(e){if(a(e)||o(e)||i(e))return e;if(t(e))return _wrap(e);throw console.error(e),new Error("'Expression must either be a Clause object or a predication function that returns true or false. Given value: "+l(e)+"'")}function _wrap(e){return new s({type:f,exprs:[e],opts:{predicate:e},conformFn:predConformer(e)})}function predConformer(e){return function(n){return e(n)?n:new u(n,e,[],"Predicate "+c(e)+" returns false")}}var t=r(10),a=r(5),o=r(15),i=r(26),s=r(1),u=r(2),c=r(3),l=r(20),f="PRED";e.exports=coerceIntoClause},function(e,n,r){"use strict";function isPred(e){return t(e)}var t=r(13);e.exports=isPred},function(e,n,r){"use strict";var t=r(4),a=r(8),o=r(8),i=o.shape,s=o.keys,u=o.mapOf,c=o.cat,l=o.fclause,f=r(54),p=r(55),d=r(49),m=r(46),v=m.wall,g=r(34),y=function(e){return c.apply(null,Array.prototype.slice.call(e).map(g))},_={any:r(47),fclause:r(21),wall:v,clause:v,nullable:f,undefinable:p,maybe:d,cstr:y},h=t({},a,{shape:i,keys:s,mapOf:u,fspec:l},_);e.exports=h},function(e,n,r){"use strict";var t=r(37),a=r(58),o=r(36),i=r(35),s=r(13),u=r(24),c=r(38),l=r(34),f=r(39),p=r(7),d=r(57),m=r(60),v=r(22),g=r(59),y=Array.isArray,_={isNull:r(23),isUndefined:r(14),notEmpty:r(61),isBool:i,isBoolean:i,isFn:s,isFunction:s,isNum:t,isNumber:t,isNatInt:a,isNaturalNumber:a,isInt:o,isInteger:o,isObj:u,isObject:u,isPlainObj:c,isPlainObject:c,isStr:p,isString:p,isArray:y,isArr:y,equal:l,equals:l,equalsTo:l,eq:l,oneOf:f,not:m,isDate:d,instanceOf:v,isUuid:g,isUUID:g};_.default=_,e.exports=_},function(e,n,r){"use strict";function isFunction(e){var n={};return(e||!1)&&["[object Function]","[object GeneratorFunction]"].indexOf(n.toString.call(e))>=0}e.exports=isFunction},function(e,n,r){"use strict";e.exports=function(e){return void 0===e}},function(e,n,r){"use strict";function isClauseRef(e){return e instanceof t}var t=r(32);e.exports=isClauseRef},function(e,n,r){"use strict";function getNamedFn(e,n,r){if(e){var t="return function "+e+(r||"")+"(){ return action.apply(this, arguments); };";return new Function("action",t)(n)}return n}e.exports=getNamedFn},function(e,n,r){"use strict";function walk(e,n,r){var a=r.phase,o=_getWalker(e);if(a){if(o[a])return o[a](n,r);throw"!"}var i=o.trailblaze(n,t({phase:"trailblaze"},r));return g(i)?i:o.reconstruct(i,t({phase:"reconstruct"},r))}function _getWalker(e){var n=v(e),r=y[n.type];if(!r)throw"unsupported type "+n.type;var t=r(n,walk);return t}var t=r(4),a=r(79),o=r(73),i=r(80),s=r(82),u=r(77),c=r(81),l=r(72),f=r(75),p=r(78),d=r(74),m=r(76),v=r(9),g=r(0),y={OR:a,CAT:a,COLL_OF:f,ANY:o,Z_OR_M:a,O_OR_M:a,Z_OR_O:a,PRED:i,WALL:s,SHAPE:c,AND:l,CLAUSE_REF:d,DELAYED:m,FCLAUSE:u,MAP_OF:p};e.exports=walk},function(e,n,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var t=r(28),a=_interopRequireDefault(t),o=r(30),i=_interopRequireDefault(o);e.exports={conform:r(25),isValid:r(68),isNamespacePath:r(67),identity:r(41),isProblem:r(0),delayed:r(40),enforce:r(63),isClause:r(5),isFclause:r(66),isClauseRef:r(15),deref:r(29),isClauseName:r(42),describe:i.default,sExpression:a.default,match:r(19)}},function(e,n,r){"use strict";function match(e,n,r){for(var t in e)return e.hasOwnProperty(t)&&n.hasOwnProperty(t)?n[t](e[t]):r(e[t]);throw console.error(e),new Error("No cases present in the given object")}e.exports=match},function(e,n,r){"use strict";function stringifyWithFnName(e,n){var r=Array.prototype.slice.call(arguments);return r[1]=function(e,r){var o;if(t(r)){var i=a(r);o=i?i+"()":r.toString()}else o=r;return n?n(o):o},JSON.stringify.apply(this,r)}var t=r(13),a=r(3);e.exports=stringifyWithFnName},function(e,n,r){"use strict";function fclause(e){var n=(e.args,e.ret,e.fn,new t({type:"FCLAUSE",exprs:[],opts:e}));return n.instrumentConformed=function(e){return a(n,e,{conform:!0,instrument:!0})},n.instrument=function(e){return a(n,e,{conform:!1,instrument:!0})},n}var t=r(1),a=r(17);r(3);e.exports=fclause},function(e,n,r){"use strict";var t=r(3),a=r(16);e.exports=function(e){var n=t(e),r=function(n){return n instanceof e};return n&&(r=a("instanceOf_"+n,r)),r.__predToString=function(){return"instanceOf_"+(n||"anonymous_type")+"_"},r}},function(e,n,r){"use strict";function isNull(e){return null===e}e.exports=isNull},function(e,n,r){"use strict";function isObject(e){return"object"===("undefined"==typeof e?"undefined":t(e))&&null!==e}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=isObject},function(e,n,r){"use strict";function conform(e,n,r){if(e&&t(e)){var a=e.conform(n);return a}throw new Error("Expression needs to be of type Clause. expression: \n"+e+"\n offending value: "+n)}var t=r(5);e.exports=conform},function(e,n,r){"use strict";var t=r(33),a=r(22);e.exports=a(t)},function(e,n,r){"use strict";function isNamespaceFragment(e){return!!/^[^.@%\&\*#]+/.test(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.NamespaceObjClause=n.ResolveFnClause=n.GetMetaFnClause=n.SetMetaFnClause=n.isNamespacePath=n.NamespaceFnClause=n.GetNSFnClause=n.SetNSFnClause=n.isClauseRef=void 0;var t=r(11),a=r(18),o=r(12),i=r(65),s=(0,a.delayed)(function(){return t.ExprClause}),u=(0,t.cat)("nsPath",a.isNamespacePath),c=(0,t.fclause)({args:u,ret:a.isClauseRef}),l=(0,t.cat)("nsPath",a.isNamespacePath,"expression",s),f=(0,t.fclause)({args:l,ret:o.isBool}),p=(0,t.or)("register",l,"retrieve",u),d=(0,t.fclause)({args:p,ret:(0,t.or)(o.isUndefined,a.isClauseRef)}),m=(0,t.fclause)({args:(0,t.cat)("source",(0,t.or)("namespacePath",a.isNamespacePath,"expression",t.ExprClause),"metaObj",o.isObj,"registry",(0,t.zeroOrOne)(o.isObj)),ret:o.isUndefined}),v=(0,t.fclause)({args:(0,t.cat)("source",(0,t.or)("namespacePath",a.isNamespacePath,"expression",t.ExprClause),"registry",(0,t.zeroOrOne)(o.isObj)),ret:(0,t.maybe)(o.isObj)}),g=(0,t.fclause)({args:(0,t.cat)("expression",t.ExprClause,"registry",(0,t.zeroOrOne)(o.isObj)),ret:a.isNamespacePath}),y=(0,t.shape)({optional:{subNamespaces:[isNamespaceFragment,(0,a.delayed)(function(){return y})],".meta":o.isObj,".expr":i}});n.isClauseRef=a.isClauseRef,n.SetNSFnClause=f,n.GetNSFnClause=c,n.NamespaceFnClause=d,n.isNamespacePath=a.isNamespacePath,n.SetMetaFnClause=m,n.GetMetaFnClause=v,n.ResolveFnClause=g,n.NamespaceObjClause=y},function(e,n,r){"use strict";function _defineProperty(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Recursive(e){this.isRecursive=!0,this.expression=e}function QuotedParamsMap(e){i(this,e)}function UnquotedParamsMap(e){i(this,e)}function Quoted(e){this.value=e}function genClauses(e){var n=d("sExpression",y(function(){return r}),"quotedParamsMap",y(function(){return a}),"unquotedParamsMap",y(function(){return o}),"optionsObj",O,"recursive",w(Recursive)),r=u(p("head",e,"params",d("labelled",l(p("label",P,"item",y(function(){return n}))),"unlabelled",l(p("item",y(function(){return n})))))),t=v(c,g(d("keyList",l(y(function(){return P})),"singleParam",y(function(){return n})))),a=f(w(QuotedParamsMap),y(function(){return t})),o=f(w(UnquotedParamsMap),y(function(){return t}));return[r,n]}function _fieldDefToFrags(e,n){var r=n.fieldDefs,t=n.keyList;if(r){var a=new QuotedParamsMap;for(var s in r)if(r.hasOwnProperty(s)){var u=_(r[s],{keyValExprPair:function(n){return _handleKeyValExprPair(e,n)},valExpressionOnly:function(n){return _createSExpr(e,o(n))}},function(){throw"!g"});i(a,_defineProperty({},s,u))}return a}if(t)return t;throw"!w"}function _handleKeyValExprPair(e,n){var r=n.keyExpression,t=n.valExpression;return new UnquotedParamsMap({key:_createSExpr(e,o(r)),val:_createSExpr(e,o(t))})}function _params(e,n){var r=k[n.type];if(r){var t=r(e,n);return t}throw console.error(n),new Error("Unsupported clause type "+n.type+".")}function _createSExpr(e,n){if(_exists(e,n))return new Recursive(n);var r=h(n),t=void 0,a=e;if("DELAYED"===r.type||"CLAUSE_REF"===r.type)return t=r.get(),_createSExpr(e,t);t=r,a=_addToRepo(e,r);var o=_params(a,t);return[t].concat(o)}function _addToRepo(e,n){if(!_exists(e,n))return e.concat([n])}function _exists(e,n){return e.indexOf(n)>=0}function sExpression(e){var n=[];return _createSExpr(n,e)}Object.defineProperty(n,"__esModule",{value:!0});var t=function(){function sliceIterator(e,n){var r=[],t=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done)&&(r.push(i.value),!n||r.length!==n);t=!0);}catch(e){a=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(a)throw o}}return r}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return sliceIterator(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=r(3),o=r(6),i=r(4),s=r(11),u=s.wall,c=s.any,l=s.zeroOrMore,f=s.and,p=s.cat,d=s.or,m=s.ExprClause,v=s.mapOf,g=s.maybe,y=r(40),_=r(19),h=r(9),b=r(12),x=b.isStr,O=b.isPlainObj,w=b.instanceOf,P=d("str",x,"quoted",w(Quoted)),E=genClauses(m),C=t(E,2),S=C[0],A=C[1],R=function(e,n){var r=n.opts.enclosedClause;return[_createSExpr(e,r)]},N=function(e,n){var r=n.opts.named,t=n.exprs;if(0===t.length)return[];if(r){var a=t.reduce(function(n,r){var t=r.name,a=r.expr;return n.concat([new Quoted(t),_createSExpr(e,a)])},[]);return a}return t.reduce(function(n,r){var t=r.expr;return n.concat([_createSExpr(e,t)])},[])},k={PRED:function(){return[]},WALL:function(e,n){var r=n.opts.enclosedClause;return[_createSExpr(e,r)]},AND:function(e,n){var r=n.opts.conformedExprs;return r.map(o).map(function(n){return _createSExpr(e,n)})},CAT:N,OR:N,Z_OR_M:R,O_OR_M:R,Z_OR_O:R,COLL_OF:R,ANY:function(){return[]},MAP_OF:function(e,n){var r=n.opts;return _handleKeyValExprPair(e,r)},SHAPE:function(e,n){var r=n.opts.conformedArgs.shapeArgs,t=r.optionalFields;t=void 0===t?{}:t;var a=t.opt,o=t.optional,s=r.requiredFields;s=void 0===s?{}:s;var u=s.req,c=s.required;return i(new UnquotedParamsMap,u||c?{required:_fieldDefToFrags(e,u||c)}:{},a||o?{optional:_fieldDefToFrags(e,a||o)}:{})},FCLAUSE:function(e,n){var r=n.opts,t=r.args,o=r.ret,s=r.fn;return i(new UnquotedParamsMap,t?{args:_createSExpr(e,t)}:{},o?{ret:_createSExpr(e,o)}:{},s?{fn:[a(s)+"()"]}:{})}};n.default=sExpression,n.SExpressionClause=S,n.ParamItemClause=A,n.Recursive=Recursive,n.QuotedParamsMap=QuotedParamsMap,n.UnquotedParamsMap=UnquotedParamsMap,n.genClauses=genClauses},function(e,n,r){"use strict";e.exports=function(e){for(var n=e;n.get;)n=n.get();return n}},function(e,n,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function describe(e,n,r){var o=(0,a.default)(e),i=t.SExpressionClause.conform(o);if(s(i))throw console.error(i),new Error("The given expression is not a valid expression.");var u=_strFragments(i,n),c=0,l=fragsToStr(u,c,r);return l}function _strFragments(e,n){return strFragments(function(e){var n=e.head,r=e.params;return{head:c(n),params:r}},e,n)}function strFragments(e,n,r){var t=e(n),a=t.head,i=t.params;if(!a)return[];if(r){var s=r(a);if(s)return s}if("PRED"===a.type)return[""+l(a.opts.predicate)];var u=o(a),c=void 0;if(i){var f=i.labelled,p=i.unlabelled,g=i.keyList;if(f){var y=f.reduce(function(n,t){var a=t.label,o=t.item;return n.concat([[_processLabel(a),", ",_fragmentParamAlts(e,o,r)]])},[]);c=interpose(y,[", ",d])}else if(p){var _=p.map(function(n){var t=n.item;return _fragmentParamAlts(e,t,r)});c=interpose(_,[", ",d])}else if(g){var h=g;c=interpose(h,[", "])}else c=[]}else c=[];return[u,"("].concat(c.length>1?[m,d]:[0===c.length?"":" "]).concat(c).concat(c.length>1?[v,d]:[0===c.length?"":" "]).concat([")"])}function interpose(e,n){return 0===e.length?e:e.reduce(function(r,t,a){return a<e.length-1&&!isSpecial(t)?r.concat([t]).concat(n):r.concat([t])},[])}function isSpecial(e){return e===d||e===m||e===v}function _fragmentParamAlts(e,n,r){var t=u(n,{label:_processLabel,sExpression:function(n){return strFragments(e,n,r)},quotedParamsMap:function(n){return _fragmentParamsObj(e,n,r,!0)},unquotedParamsMap:function(n){return _fragmentParamsObj(e,n,r,!1)},optionsObj:function(e){return f(e)},recursive:function(e){var n=e.expression;return["<recursive>: ",o(n)]}},function(){throw"!s"});return t}function _processLabel(e){var n=e.str,r=e.quoted;return n?n:r?'"'+r.value+'"':void 0}function _fragmentParamsObj(e,n,r,t){var a=["{",m,d],o=[];for(var i in n)if(n.hasOwnProperty(i)){var s=[];s.push(t?'"'+i+'": ':"<"+i+">: ");var c=u(n[i],{keyList:function(e){return["[ "].concat(interpose(e.map(function(e){return'"'+e+'"'}),[", "])).concat(" ]")},singleParam:function(n){return _fragmentParamAlts(e,n,r)}},function(){throw"!e"});c&&(s.push(c),o.push(s))}return o=interpose(o,[", ",d]),a=a.concat(o).concat([v,d,"}"])}function fragsToStr(e,n,r){var t=n,a=!1;return e.reduce(function(e,n){if(a&&(a=!1,e=e.concat(p(r*t," ").join(""))),i(n))return e.concat(n);if(Array.isArray(n))return e.concat(fragsToStr(n,t,r));if(n===d){if(r>0)return a=!0,e.concat("\n")}else if(n===m)t+=1;else{if(n!==v)throw console.error(n),"!3";t-=1}return e},"")}Object.defineProperty(n,"__esModule",{value:!0}),n.isSpecial=n.interpose=n.INDENT_OUT=n.INDENT_IN=n.NEW_LINE=n.fragsToStr=n.humanReadable=void 0;var t=r(28),a=_interopRequireDefault(t),o=r(64),i=r(7),s=r(0),u=r(19),c=r(6),l=r(3),f=r(20),p=r(70),d=function(){},m=function(){},v=function(){};n.default=describe,n.humanReadable=o,n.fragsToStr=fragsToStr,n.NEW_LINE=d,n.INDENT_IN=m,n.INDENT_OUT=v,n.interpose=interpose,n.isSpecial=isSpecial},function(e,n,r){"use strict";(function(e){function _getUnchecked(e){function getFn(n){var r=t;r=n?n+e:e;var o=y.get(t,_slashToDot(r));return o?a(o[".expr"],o[".meta"]):void 0}var n=new o({ref:e,getFn:getFn,conformFn:null});return n.conform=function(e){var n=getFn();return m(n,e,{conform:!0})},n}function _slashToDot(e){return e.replace(/^(.+)(\/)(.+)$/,"$1.$3").replace(/^\//,"")}function getNamespacePath(e){var n,r=e.nsPath,t=S(r);return n=t}function setNamespacePath(e){var n=e.nsPath,r=e.expression;_processVal(n,r)}function _processVal(e,n){if(n){if(n.clause||n.pred){var r=n.clause||n.pred;return R(e,{".expr":r}),r}throw console.error(n),"!"}throw console.error(n),"!"}function _maybeInitRegistry(){return t||clearRegistry(),t}function clearRegistry(){t=e[N]={}}function resolve(e,n){return n?v(e,n):v(e,M())}Object.defineProperty(n,"__esModule",{value:!0});var t,a=r(4),o=r(32),i=r(11),s=i.cat,u=i.or,c=i.fclause,l=i.shape,f=r(5),p=r(10),d=r(35),m=r(17),v=r(43),g=r(9),y=r(56),_=r(18),h=_.isNamespacePath,b=_.isClauseRef,x=r(27),O=x.GetNSFnClause,w=x.SetNSFnClause,P=x.NamespaceFnClause,E=x.SetMetaFnClause,C=x.GetMetaFnClause,S=c({args:s(h),ret:b}).instrument(_getUnchecked),A=l({req:{".expr":u(f,p)}}),R=c({args:s(h,A),ret:d}).instrument(function(e,n){_maybeInitRegistry();var r=y.get(t,_slashToDot(e));return y.set(t,_slashToDot(e),a({},r,n)),!0}),N="___CLAUSEJS_REGISTRY",k=E.instrumentConformed(function(e){var n=e.source,r=n.namespacePath,o=n.expression,i=e.metaObj,s=e.registry;if(s||(s=t),r){var u=y.get(s,_slashToDot(r)),c=u&&u[".meta"];y.set(s,_slashToDot(r),a({},u,{".meta":a({},c,i)}))}else if(o){var l=g(o);l.meta=a(l.meta,i)}}),F=C.instrumentConformed(function(e){var n=e.source,r=n.namespacePath,a=n.expression,o=e.registry;if(o||(o=t),r){var i=y.get(o,_slashToDot(r)),s=i&&i[".meta"];return s}if(a){var u=g(a);return u.meta}});_maybeInitRegistry();var M=function(){return t},j=P.instrumentConformed(function(e){var n=e.register,r=e.retrieve;return n?setNamespacePath(n):r?getNamespacePath(r):void 0});j.get=O.instrumentConformed(getNamespacePath),j.set=w.instrumentConformed(setNamespacePath),j.clearRegistry=clearRegistry,j.getRegistry=M,j.setMeta=k,n.getRegistry=M,n.clearRegistry=clearRegistry,n.setMeta=k,n.getMeta=F,n.resolve=resolve,n.default=j}).call(n,r(83))},function(e,n,r){"use strict";function ClauseRef(e){var n=e.ref,r=e.getFn,t=e.conformFn;this.type="CLAUSE_REF",this.get=r,this.conform=t,this.ref=n}var t=r(1);ClauseRef.prototype=Object.create(t.prototype),e.exports=ClauseRef},function(e,n,r){"use strict";function DelayedClause(e){var n=e.getFn;this.type="DELAYED",this.get=n;var r=this;r.instrument=function(e){var r=n();return r.instrument(e)},r.instrumentConformed=function(e){var r=n();return r.instrumentConformed(e)},r.conform=function(e){var r=n();return r.conform(e)}}var t=r(1);DelayedClause.prototype=Object.create(t.prototype),e.exports=DelayedClause},function(e,n,r){"use strict";e.exports=function(e){return function(n){return n===e}}},function(e,n,r){"use strict";function isBool(e){return"boolean"==typeof e}e.exports=isBool},function(e,n,r){"use strict";function isInt(e){return"number"==typeof e&&(Math.floor(e)===e&&e!==1/0)}e.exports=isInt},function(e,n,r){"use strict";function isNum(e){return"number"==typeof e}e.exports=isNum},function(e,n,r){"use strict";function isPlainObject(e){if(t(e)){if("function"==typeof Object.getPrototypeOf){var n=Object.getPrototypeOf(e);return n===Object.prototype||null===n}return"[object Object]"==Object.prototype.toString.call(e)}return!1}var t=r(24);e.exports=isPlainObject},function(e,n,r){"use strict";e.exports=function(){var e;if(1===arguments.length&&Array.isArray(arguments[0]))e=arguments[0];else{if(!(arguments.length>0))throw new Error("Items list is required.");e=Array.prototype.slice.call(arguments)}var n=function(n){return e.indexOf(n)>=0};return n.__predToString=function(){return"oneOf(".concat([e.map(JSON.stringify).join(", ")]).concat(")")},n}},function(e,n,r){"use strict";function delayed(e){return new t({getFn:e})}var t=r(33);e.exports=delayed},function(e,n,r){"use strict";function identity(e){return e}e.exports=identity},function(e,n,r){"use strict";var t=r(7);e.exports=function(e){return t(e)}},function(e,n,r){"use strict";function resolve(e,n){var r=_findFirst(o,function(e){var r=t(e,2),a=r[0],o=r[1];if(a===n)return o});return r||(r=_createResolveMap(n),o.push([n,r])),_resolveWithMap(r,e)}function getDefList(e){var n=_createResolveMap(e),r={};return n.forEach(function(e){var n=t(e,1),a=n[0];r[a]||(r[a]=[]),r[a].push(e)}),r}function _createResolveMap(e){var n=[],r=a.NamespaceObjClause.conform(e);return _walk(null,null,r,n),n}function _walk(e,n,r,t){var a=e?e+"."+n:n,o=void 0;for(var i in r)if(r.hasOwnProperty(i))switch(i){case"subNamespaces":o=r[i];for(var s in o)o.hasOwnProperty(s)&&_walk(a,s,o[s],t);break;case".expr":t.push([""+(e?e:""),""+n,r[".expr"]])}}function _resolveWithMap(e,n){var r=_findFirst(e,function(e){var r=t(e,3),a=r[0],o=r[1],i=r[2];if(i===n||_tryStripPredClause(i)===_tryStripPredClause(n))return a+"/"+o});return r}function _tryStripPredClause(e){return"PRED"===e.type?e.opts.predicate:e}function _findFirst(e,n){for(var r=0;r<e.length;r++){var t=n(e[r]);if(t)return t}return null}var t=function(){function sliceIterator(e,n){var r=[],t=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done)&&(r.push(i.value),!n||r.length!==n);t=!0);}catch(e){a=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(a)throw o}}return r}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return sliceIterator(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=r(27),o=[];e.exports={resolve:resolve,getDefList:getDefList}},function(e,n,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var t=r(31),a=_interopRequireDefault(t),o=r(4),i=r(11),s=r(18),u=r(12),c={Problem:r(2),Clause:r(1)},l=o(a.default,{resolve:t.resolve},i,s,c,u);l.VERSION=r(45),e.exports=l,n.default=l},function(e,n,r){"use strict";e.exports="0.1.0"},function(e,n,r){"use strict";function wallOp(e){var n=a(e),r=new t({type:"WALL",exprs:[n],opts:{enclosedClause:n}});return r.conform=function(e){return c(r,e,{conform:!0})},r}var t=r(1),a=r(9),o=r(8),i=o.cat,s=o.ExprClause,u=r(21),c=r(17),l=u({args:i(s),ret:s}),f=l.instrument(wallOp);e.exports={WallFnClause:l,wall:f}},function(e,n,r){"use strict";function any(){return new t({type:o,exprs:[],conformFn:a})}var t=r(1),a=r(41),o="ANY";e.exports=any},function(e,n,r){"use strict";e.exports={CAT:"CAT",OR:"OR",Z_OR_M:"Z_OR_M",Z_OR_O:"Z_OR_O",O_OR_M:"O_OR_M",PRED:"PRED",COLL_OF:"COLL_OF"}},function(e,n,r){"use strict";function maybe(e){return a(o,i,e)}var t=r(8),a=t.or,o=r(23),i=r(14);e.exports=maybe},function(e,n,r){"use strict";function evalClause(e){e=o(e);var n;if(null===e.type)throw"Clause has no type: "+e;n=e.type in s?s[e.type]:s.PRED;var r=n(e);return r}function wrapRoot(e){return new a({type:"ROOT",exprs:[e]})}var t=r(51),a=r(1),o=r(29),i=function(e){for(var n=0,r=[e.head],t=[];r.length>0;){var a=r.pop();null===a.index&&(a.index=n,n++,a.transitions.forEach(function(e){r.push(e.target)}),t.push(a))}return t},s={},u=function(e){return function(n){var r=evalClause(n.exprs[0]);return e(r)}},c=function(e){return function(n){var r=n.exprs.map(function(e){var n=evalClause(e.expr);return n.name=e.name,n});return e(r)}};["ROOT","Z_OR_M","O_OR_M","Z_OR_O"].forEach(function(e){s[e]=u(t[e])}),["OR","CAT"].forEach(function(e){s[e]=c(t[e])}),s.PRED=function(e){return t.PRED(e)};var l=function(e){var n,r=wrapRoot(e),t=evalClause(r),a=i(t),o=a.length,s={};return a.forEach(function(e){0===e.transitions.length&&(n=e.index);var r={};e.transitions.forEach(function(e){r[e.target.index]=e.clause}),s[e.index.toString()]=r}),{initialState:0,numStates:o,finalState:n,transitions:s,expression:e}};e.exports=l},function(e,n,r){"use strict";function fragmentState(e,n){return{transitions:null===e?[]:e,index:n||null}}function fragmentTransition(e,n){return{clause:e,target:n}}function fragment(e,n){return{head:e,tails:n}}function namedFragment(e,n,r){
var t=fragment(n,r);return t.name=e,t}function patch(e,n){e.forEach(function(e){e.target=n})}function epsilonState(){return{isEpsilon:!0}}function namedEpsilonState(e,n,r,t){var a=epsilonState();return a.name=n,a.op=r,a.group=t,a.dir=e,a}function frontWithState(e,n){var r=fragmentTransition(e,n.head),t=fragmentState([r]),a=fragment(t,n.tails);return a}function rearWithState(e,n){var r=fragmentTransition(e,null),t=fragmentState([r],null);patch(n.tails,t);var a=fragment(n.head,[r]);return a}var t={};t.PRED=function(e){var n=fragmentTransition(e,null),r=fragmentState([n],null),t=[n],a=fragment(r,t);return a},t.OR=function(e){e=e.map(function(e){var n=namedEpsilonState("out",e.name,"OR"),r=fragmentTransition(n,null),t=fragmentState([r]);patch(e.tails,t);var a=fragmentTransition(namedEpsilonState("in",e.name,"OR"),e.head),o=fragmentState([a]),i=namedFragment(e.name,o,[r]);return i});var n=function(e,n){var r=e.head.transitions.concat(n.head.transitions),t=fragmentState(r),a=e.tails.concat(n.tails),o=namedFragment(e.name,t,a);return o},r=e.reduce(n);return r=frontWithState(namedEpsilonState("enter",null,"OR","para_in"),r),r=rearWithState(namedEpsilonState("exit",null,"OR","para_out"),r)},t.CAT=function(e){var n=function(e,n){patch(e.tails,n.head);var r=e.head,t=n.tails,a=fragment(r,t);return a};e=e.map(function(e){var n=fragmentTransition(namedEpsilonState("maybe_out",e.name,"CAT"),null),r=fragmentState([n]);patch(e.tails,r);var t=e.head.transitions.map(function(n){var r=fragmentState([n]),t=fragmentTransition(namedEpsilonState("maybe_in",e.name,"CAT"),r);return t}),a=fragmentState(t),o=namedFragment(e.name,a,[n]);return o});var r;if(e.length>0)r=e.reduce(n);else{var t=epsilonState(),a=fragmentTransition(t,null),o=fragmentState([a]);r=fragment(o,[a])}return r=frontWithState(namedEpsilonState("maybe_enter",null,"CAT","in"),r),r=rearWithState(namedEpsilonState("maybe_exit",null,"CAT","out"),r)},t.Z_OR_M=function(e){var n="Z_OR_M",r=fragmentTransition(namedEpsilonState("loop",null,n),e.head),t=fragmentTransition(epsilonState(),null),a=fragmentState([r,t]);patch(e.tails,a);var o=fragment(a,[t]),i=o.head.transitions.map(function(e){var n=fragmentState([e]),r=fragmentTransition(epsilonState(),n);return r}),s=fragmentState(i);return o=fragment(s,o.tails),o=frontWithState(namedEpsilonState("maybe_enter",null,n,"in"),o),o=rearWithState(namedEpsilonState("maybe_exit",null,n,"out"),o)},t.O_OR_M=function(e){var n="O_OR_M",r=fragmentTransition(namedEpsilonState("loop",null,n),e.head),t=fragmentTransition(epsilonState(),null),a=fragmentState([r,t]);patch(e.tails,a);var o=fragment(e.head,[t]);return o=frontWithState(namedEpsilonState("maybe_enter",null,n,"in"),o),o=rearWithState(namedEpsilonState("maybe_exit",null,n,"out"),o)},t.Z_OR_O=function(e){var n="Z_OR_O",r=fragmentTransition(namedEpsilonState("loop",null,n),e.head),t=fragmentTransition(epsilonState(),null),a=fragmentState([r,t]),o=e.tails.concat([t]),i=fragment(a,o);return i=frontWithState(namedEpsilonState("maybe_single_enter",null,n,"in"),i),i=rearWithState(namedEpsilonState("maybe_single_exit",null,n,"out"),i)},t.ROOT=function(e){var n=fragmentState(null,null);return patch(e.tails,n),fragment(e.head,[])},e.exports=t},function(e,n,r){"use strict";function _defineProperty(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function Value(e){this.value=e}function Piece(e){this.fragment=e}function GroupedPiece(e){this.fragment=e}function NamedPiece(e,n){this.fragment=n,this.name=e}function GroupedAltPiece(e){this.fragment=e}function NamedAltPiece(e,n){this.fragment=n,this.name=e}function Nothing(){}function Empty(){}function MaybeEnter(){}function GroupName(e){this.name=e}function getMatch(e,n,r){var t,a=r.conform,o=e.inputType,i=[];if(e.forEach(function(e){if(e.move)switch(e.move.dir){case"maybe_enter":i.push(new MaybeEnter);break;case"maybe_exit":for(var t=void 0,s=new Empty;!((t=i.pop())instanceof MaybeEnter);)s=_foldLeft(o,a,s,t);i.push(s);break;case"maybe_single_enter":i.push(new MaybeEnter);break;case"maybe_single_exit":var u=i.pop(),c=void 0;u instanceof MaybeEnter?c=new Nothing:(c=u,i.pop()),i.push(c);break;case"enter":break;case"exit":var l=i.pop(),f=void 0;if(a&&l instanceof NamedAltPiece){var p=void 0;p=l.fragment instanceof Empty?{}:_defineProperty({},l.name,l.fragment),f=new GroupedAltPiece(p)}else f=l;i.push(f);break;case"maybe_in":a&&e.move.name&&i.push(new GroupName(e.move.name));break;case"loop":break;case"maybe_out":if(a&&e.move.name){var d=i.pop(),m=i.pop();i.push(_giveName(m,d))}break;case"in":a&&e.move.name&&i.push(new GroupName(e.move.name));break;case"out":if(a&&e.move.name){var v=i.pop(),g=i.pop();i.push(_giveAltName(g,v))}break;case"clause":var y=n(e.clause,e.guide,r);i.push(new Value(y));break;default:throw console.error(e),"FUUU"}}),1!==i.length)throw console.error("valStack",i),"!";t=i.pop();var s=void 0;return s=t instanceof Piece?t.fragment:t instanceof GroupedPiece?t.fragment:t instanceof GroupedAltPiece?t.fragment:t instanceof Value?t.value:t instanceof Empty?_coerceToProperType(o,[]):t instanceof Nothing?null:t}function _giveName(e,n){if(n instanceof Nothing)return new NamedPiece(e.name,new Empty);if(n instanceof GroupedPiece)return new NamedPiece(e.name,n.fragment);if(n instanceof Piece||n instanceof GroupedAltPiece)return new NamedPiece(e.name,n.fragment);if(n instanceof Value)return new NamedPiece(e.name,n.value);if(n instanceof Empty)return new NamedPiece(e.name,new Empty);throw console.error(n),"c!!!"}function _giveAltName(e,n){if(n instanceof Nothing)return new NamedAltPiece(e.name,new Empty);if(n instanceof GroupedAltPiece)return new NamedAltPiece(e.name,n.fragment);if(n instanceof Piece)return new NamedAltPiece(e.name,n.fragment);if(n instanceof GroupedPiece)return new NamedAltPiece(e.name,n.fragment);if(n instanceof Value)return new NamedAltPiece(e.name,n.value);if(n instanceof Empty)return new NamedAltPiece(e.name,new Empty);throw console.error(n),"c!!!alt"}function _foldLeft(e,n,r,a){if(n&&a instanceof NamedPiece){var o=void 0;if(r instanceof Nothing)o={};else if(r)if(r instanceof Empty)o={};else if(r instanceof GroupedPiece)o=r.fragment;else if(r instanceof Piece)o=r.fragment;else{if(!(r instanceof GroupedAltPiece))throw console.error(r,a),"!!acc_fl_np";o=r.fragment}else o={};var i=void 0;i=a.fragment instanceof Empty?{}:_defineProperty({},a.name,a.fragment);var s=new GroupedPiece(t({},i,o));return s}var u=void 0,c=void 0;if(r instanceof Nothing)c=[];else if(r)if(r instanceof Piece)c=r.fragment;else if(r instanceof GroupedPiece)c=[r.fragment];else{if(!(r instanceof Empty))throw console.error(r),"!!acc_fl";c=[]}else c=[];if(a instanceof Value)u=[a.value];else if(a instanceof Piece)u=a.fragment;else if(a instanceof GroupedPiece)u=[a.fragment];else if(a instanceof GroupedAltPiece)u=[a.fragment];else if(a instanceof Nothing)u=[];else{if(!(a instanceof Empty))throw console.error(a),"cc!!";u=[]}var l=new Piece(_coerceToProperType(e,u.concat(c)));return l}function _coerceToProperType(e,n){return"string"===e&&Array.isArray(n)?n.join(""):n}var t=r(4);e.exports=getMatch},function(e,n,r){"use strict";function simulate(e,n,r,a){for(var o={matched:!1,chain:null},i="undefined"==typeof n?"undefined":t(n),s={state:0,offset:0,input:[n],groupCount:0,arrayed:!1},u=[s];u.length>0;){var c=u.shift(),l=c.offset,f=c.input;if(c.state===e.finalState&&l===f.length)return o.matched=!0,o.chain=_getChain(e,c,i),o;for(var p in e.transitions[c.state]){var d=parseInt(p),m=_getNextMove(e,d,c,r,a);if(m)if(m.isProblem){var v=m.name,g=m.problem,y=m.position;o.lastProblem={name:v,problem:g,position:y}}else u.push(m)}}return o}function _getNextMove(e,n,r,t,i){var s=r.input,u=r.offset,c=r.groupCount,l=r.arrayed,f=s[u],p=e.transitions[r.state][n];"in"===p.group?(0===c&&(Array.isArray(s[0])||o(s[0]))&&(s=s[0],u=0,l=!0),c+=1):"out"===p.group&&(c-=1,0===c&&(l&&(u=u===s.length?1:0,s=[s]),l=!1));var d,m;d=p.isEpsilon?u:u+1;var v,g,y=p.name||r.move&&r.move.name;if(d<=s.length){if(p.isEpsilon)return m=p.dir?{dir:p.dir,name:p.name,op:p.op,group:p.group}:null,g={input:s,groupCount:c,arrayed:l,state:n,offset:d,move:m,clause:p,prev:r,isEpsilon:!0};if(v=t(p,f,i),a(v))return{isProblem:!0,problem:v,name:y,position:u};if(u<s.length)return m={dir:"clause"},g={input:s,groupCount:c,arrayed:l,state:n,offset:d,move:m,prev:r,isEpsilon:!1,clause:p,guide:v}}}function _getChain(e,n,r){for(var t,a=[],o=n;o;){if(!t||o.state!==t.state&&o.move){var i={isEpsilon:o.isEpsilon,move:o.move,state:o.state};o.isEpsilon||(i.guide=o.guide,i.clause=o.clause),a.unshift(i)}t=o,o=o.prev}return a.inputType=r,a}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=r(0),o=r(7);e.exports=simulate},function(e,n,r){"use strict";function nullable(e){return a(o,e)}var t=r(8),a=t.or,o=r(23);e.exports=nullable},function(e,n,r){"use strict";function undefinable(e){return a(o,e)}var t=r(8),a=t.or,o=r(14);e.exports=undefinable},function(e,n,r){"use strict";function get(e,n,r){if("number"==typeof n&&(n=[n]),!n||0===n.length)return e;if(null==e)return r;if("string"==typeof n)return get(e,n.split("."),r);var t=getKey(n[0]),a=e[t];return void 0===a?r:1===n.length?a:get(e[t],n.slice(1),r)}function set(e,n,r){if("number"==typeof n&&(n=[n]),!n||0===n.length)return e;if("string"==typeof n)return set(e,n.split(".").map(getKey),r);var t=n[0],a=e[t];return 1===n.length?(e[t]=r,a):(void 0===a&&("number"==typeof n[1]?e[t]=[]:e[t]={}),set(e[t],n.slice(1),r))}function getKey(e){var n=parseInt(e);return n.toString()===e?n:e}e.exports={get:get,set:set}},function(e,n,r){"use strict";e.exports=function(e){return e&&e instanceof Date&&!isNaN(e.valueOf())}},function(e,n,r){"use strict";function isNatInt(e){return t(e)&&e>=0}var t=r(36);e.exports=isNatInt},function(e,n,r){"use strict";e.exports=function(e){return!!/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}},function(e,n,r){"use strict";function not(e){var n=t(e),r=function(n){return!e(n)};return n?a("not_"+n,r):r}var t=r(3),a=r(16);e.exports=not},function(e,n,r){"use strict";e.exports=function(e){return!!e&&0!==e.length}},function(e,n,r){"use strict";function betterThrow(e){throw e}e.exports=betterThrow},function(e,n,r){"use strict";var t=r(0),a=r(25);e.exports=function(e,n){var r=a(e,n);if(t(r))throw r}},function(e,n,r){"use strict";function humanReadable(e){return t(e)?e:e.type?a[e.type]?a[e.type]:e.type.toLowerCase():e.toString()}var t=r(7),a={Z_OR_M:"zeroOrMore",O_OR_M:"oneOrMore",Z_OR_O:"zeroOrOne",COLL_OF:"collOf",MAP_OF:"mapOf"};e.exports=humanReadable},function(e,n,r){"use strict";function isExpr(e){return t(e)||a(e)||o(e)||i(e)}var t=r(10),a=r(5),o=r(15),i=r(26);e.exports=isExpr},function(e,n,r){"use strict";function isFclause(e){return t(e)&&"FCLAUSE"===e.type}var t=r(5);e.exports=isFclause},function(e,n,r){"use strict";function isNamespacePath(e){return t(e)&&/^\/?[a-zA-Z0-9\-_\.]*\/([a-zA-Z0-9\-_]+)$/.test(e)}var t=r(7);e.exports=isNamespacePath},function(e,n,r){"use strict";function isValid(e,n){if(e)return o(e)?!t(i(e,n)):!a(e)||e(n);throw new Error("Clause is required")}var t=r(0),a=r(10),o=r(5),i=r(25);e.exports=isValid},function(e,n,r){"use strict";e.exports=function(e,n,r){var t=function(r){return Object.defineProperty(e,n,{value:r,enumerable:!0,writable:!0})};return Object.defineProperty(e,n,{configurable:!0,enumerable:!0,get:function(){var e=r();return t(e),e},set:function(e){t(e)}}),e}},function(e,n,r){"use strict";function repeat(e,n){var r,t=[];for(r=0;r<e;r++)t.push(n);return t}e.exports=repeat},function(e,n,r){"use strict";var t=[9,10,11,12,13,32,160,5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288,65279];e.exports=t.reduce(function(e,n){return e+String.fromCharCode(n)},"")},function(e,n,r){"use strict";function andWalker(e,n){function andTrailblaze(e,o){for(var s=e,u=[],c=[],l=0;l<r.length;l+=1){var f=0===l?e:u[l-1];if(s=n(r[l],f,o),a(s)){c.push(s);break}var p=n(r[l],s,i({},o,{phase:"reconstruct"}));u.push(p)}return 0===c.length?{conforms:u}:new t(e,r,c,"One or more expressions failed AND test")}function andReconstruct(e){var n=e.conforms;return n[r.length-1]}var r=e.opts.conformedExprs.map(o);return{trailblaze:andTrailblaze,reconstruct:andReconstruct}}var t=r(2),a=r(0),o=r(6),i=r(4);e.exports=andWalker},function(e,n,r){"use strict";function anyWalker(){return{trailblaze:walkThroughAny,reconstruct:walkThroughAny}}function walkThroughAny(e){return e}e.exports=anyWalker},function(e,n,r){"use strict";function clauseRefWalker(e,n){function walkClauseRef(r,t){var a=e.get();if(a)return n(a,r,t)}return{trailblaze:walkClauseRef,reconstruct:walkClauseRef}}e.exports=clauseRefWalker},function(e,n,r){"use strict";function collOfWalker(e,n){function collOfTrailblaze(s,u){var c=[],l=[];if(Array.isArray(s)){if(i){var f=i.maxCount,p=i.minCount;if(o(f)&&s.length>f)return new t(s,e,l,"collOf: collection size "+s.length+" exceeds maxCount "+f+".");if(o(p)&&s.length<p)return new t(s,e,l,"collOf: collection size "+s.length+" is less than minCount "+p+".")}for(var d=0;d<s.length;d+=1){var m=n(r,s[d],u);if(a(m)){l.push(m);break}c.push(m)}return l.length>0?new t(s,e,l,"One or more elements failed collOf test"):c}return new t(s,e,[],"collOf expects an array")}function collOfReconstruct(e,t){for(var a=[],o=0;o<e.length;o+=1){var i=n(r,e[o],t);a.push(i)}return a}var r=e.exprs[0],i=e.opts;return{trailblaze:collOfTrailblaze,reconstruct:collOfReconstruct}}var t=r(2),a=r(0),o=r(37);e.exports=collOfWalker},function(e,n,r){"use strict";function delayedClauseWalker(e,n){function walkDelayedClause(r,t){var a=e.get();if(a)return n(a,r,t)}return{trailblaze:walkDelayedClause,reconstruct:walkDelayedClause}}e.exports=delayedClauseWalker},function(e,n,r){"use strict";function fclauseWalker(e,n){function fclauseTrailblaze(e){return e}function fclauseReconstruct(e,n){if(!e)throw new Error("A function must be clauseified for instrumentation.");var r=n.conform,t=n.instrument;return r&&t?instrumentConformed(e,n):t?_instrument(e,n):void 0}function _instrument(e,n){var r=o(e),t=getInstrumentedFn(r,e,n),a=i(r,t,"__instrumented");return a}function instrumentConformed(e,n){var r=o(e),t=getArgConformedInstrumentedFn(r,e,n),a=i(r,t,"__conformed");return a}function getInstrumentedFn(e,r){return function(){var t=Array.prototype.slice.call(arguments),a=checkArgs(r,e,t),o=r.apply(this,a),i=checkRet(r,e,o),s=u?n(u,t,{conform:!0,instrument:!0}):t,f=void 0;return f=c?n(c,o,{conform:!0,instrument:!0}):o,checkFnRelation(e,r,l,s,f),i}}function checkFnRelation(n,r,t,o,i){if(t){var u=t.call(null,o,i);if(!u){var c=new a({args:o,ret:i},e,[],"Function "+n+" failed valiation on argument-return value relation");s(c)}}}function checkArgs(r,o,i){var c=o||"<anonymous>";if(!u)return i;var l=n(u,i,{phase:"trailblaze"});if(!t(l))return n(u,l,{phase:"reconstruct",conform:!1,instrument:!0});var f=new a(i,e,[l],"Arguments for function "+c+"() is not valid");s(f)}function checkRet(r,o,i){var u=o||"<anonymous>";if(!c)return i;var l=n(c,i,{phase:"trailblaze"});if(!t(l)){var f=n(c,l,{phase:"reconstruct",instrument:!0,conform:!1});return f}var p=new a(i,e,[l],"Return value for function "+u+"() is not valid");s(p)}function getArgConformedInstrumentedFn(e,r){var o=e||"<anonymous>";return function(){var i=Array.prototype.slice.call(arguments),f=n(u,i,{conform:!0,instrument:!0});if(t(f)){var p=new a(i,u,[f],"Arguments for function "+o+" is not valid");s(p)}var d=r.call(this,f);if(checkRet(r,e,d),l){var m;m=c?n(c,d,{conform:!0,instrument:!0}):d,checkFnRelation(e,r,l,f,m)}return d}}var r=e.opts,u=r.args,c=r.ret,l=r.fn;return{trailblaze:fclauseTrailblaze,reconstruct:fclauseReconstruct}}var t=r(0),a=r(2),o=r(3),i=r(16),s=r(62);e.exports=fclauseWalker},function(e,n,r){"use strict";function _defineProperty(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function mapOfWalker(e,n){function mapOfTrailblaze(r,t){var i={};for(var s in r)if(r.hasOwnProperty(s)){var l=n(u,s,t);if(a(l))return new o(r,e,_defineProperty({},s,l),"mapOf: key "+s+" failed validation");var f=n(c,r[s],t);if(a(f))return new o(r,e,_defineProperty({},s,f),"mapOf: value for key "+s+" failed validation");i[s]={expr:c,valGuide:f}}return i}function mapOfReconstruct(e,r){var t={};for(var a in e){var o=e[a],i=o.expr,s=o.valGuide;t[a]=n(i,s,r)}return t}var r=e.opts,i=r.keyExpression,s=r.valExpression,u=i&&t(i),c=s&&t(s);return{trailblaze:mapOfTrailblaze,reconstruct:mapOfReconstruct}}var t=r(6),a=r(0),o=r(2);e.exports=mapOfWalker},function(e,n,r){"use strict";function _defineProperty(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function nfaWalker(e,n){function nfaTrailblaze(a,s){r||(r=o(e));var u=t(r,a,n,s),c=u.chain,l=u.matched,f=u.lastProblem;if(l===!0)return{chain:c};var p=void 0;if(f){var d=f.name,m=f.position,v=f.problem;p=_defineProperty({},d?'"'+d+'"':"<At position "+m+">",v)}else p=[];return new i(a,e,p,"Clause "+e.type+" did not match value")}function nfaReconstruct(e,r){var t=e.chain,o=a(t,n,r);return o}var r;return{trailblaze:nfaTrailblaze,reconstruct:nfaReconstruct}}var t=r(53),a=r(52),o=r(50),i=r(2);e.exports=nfaWalker},function(e,n,r){"use strict";function predWalker(e){function predTraiblaze(n){var r=e.exprs[0];return r(n)?n:new a(n,e,[],"Predicate "+t(r)+"() returns false")}function predReconstruct(e){return e}return{trailblaze:predTraiblaze,reconstruct:predReconstruct}}var t=r(3),a=r(2);e.exports=predWalker},function(e,n,r){"use strict";function shapeWalker(e,n){function shapeTrailblaze(s,l){function processFieldDefs_mut(e){e:for(var r in e)if(e.hasOwnProperty(r)){var t=e[r],a=getFieldGuide(s,r,t,n,l),o=a.noop,i=a.problem,u=a.singleMatch,c=a.groupMatch;if(i){d.push([r,i]);break e}if(u)m.singles.push(u);else if(c)c.matchedKeys.length>0&&m.groups.push(c);else if(!o)throw"!"}}if(["object","function"].indexOf("undefined"==typeof s?"undefined":a(s))<0)return new u(s,e,[],"Value is not an object");r||(r=_genKeyConformer(i,c,n,l));var f=r(s);if(o(f))return f;var p,d=[],m={val:s,groups:[],singles:[]};i&&(p=i.fieldDefs),p&&processFieldDefs_mut(p);var v;if(c&&(v=c.fieldDefs),v&&processFieldDefs_mut(v,!0),d.length>0){for(var g={},y=[],_=0;_<d.length;_++){var h=t(d[_],2),b=h[0],x=h[1];y.push(b),g[b]=x}var O=new u(s,e,g,"At least one property failed validation: "+y.join(", "));return O}return m}function shapeReconstruct(e,r){var t,a=e.val,o=e.singles,i=e.groups,u={walkOpts:r},c=r.mutate;return t=c?a:s({},a),o.forEach(function(e){restoreField_mut(t,e,n,r)}),i.forEach(function(e){var a=e.name,o=e.matchedKeys;if(u){t[a]={};var i=[];o.forEach(function(e){restoreField_mut(t[a],e,n,r),i.push(e.key)}),_deleteKeys(t,i)}else o.forEach(function(e){restoreField_mut(t,e,n,r)})}),t}var r,i,c,l=e.opts.conformedArgs.shapeArgs,f=l.requiredFields,p=l.optionalFields;return f&&(i=f.req||f.required),p&&(c=p.opt||p.optional),{trailblaze:shapeTrailblaze,reconstruct:shapeReconstruct}}function restoreField_mut(e,n,r,t){var a=n.key,o=n.clause,i=n.guide;e[a]=r(o,i,t)}function _genKeyConformer(e,n,r,t){return function(n){if(e){var a,i=[],s=e.fieldDefs,c=e.keyList;if(s){a=[];for(var l in s)s.hasOwnProperty(l)&&a.push(l)}else{if(!c)throw"unsupported";a=[].concat(c)}for(var f=0;f<a.length;f++){var p=a[f];if(s&&s[p].keyValExprPair){var d=!1;e:for(var m in n)if(n.hasOwnProperty(m)){var v=_conformNamedOrExpr(m,s[p].keyValExprPair.keyExpression,r,t);if(!o(v)){d=!0;break e}}d||i.push(p)}else if(s&&s[p].valExpressionOnly)if(n.hasOwnProperty(p)){var g=_conformNamedOrExpr(n[p],s[p].valExpressionOnly,r,t);o(g)&&i.push(p)}else i.push(p);else{if(!c)throw"!";void 0===n[p]&&i.push(p)}}if(i.length>0)return new u(n,e,[],"req: keys required: "+i.join(", "))}return n}}function _deleteKeys(e,n){for(var r=0;r<n.length;r++)delete e[[n[r]]]}function getFieldGuide(e,n,r,t,a){var s=r.valExpressionOnly,u=r.keyValExprPair;if(u){var l=[],f=u.keyExpression,p=u.valExpression;e:for(var d in e)if(e.hasOwnProperty(d)){var m=_conformNamedOrExpr(d,f,t,a);if(!o(m)){if(e===e[d])continue e;var v=_conformNamedOrExpr(e[d],p,t,a);if(o(v))return{problem:v};l.push({key:d,clause:c(p),guide:v})}}return{groupMatch:{name:n,matchedKeys:l}}}if(s){var g=e[n];if(i(g)||e[n]===e)return{noop:!0};var y=_conformNamedOrExpr(g,s,t,a);return o(y)?{problem:y}:{singleMatch:{key:n,clause:c(s),guide:y}}}throw"!!"}function _conformNamedOrExpr(e,n,r,t){var a=c(n),o=r(a,e,t);return o}var t=function(){function sliceIterator(e,n){var r=[],t=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done)&&(r.push(i.value),!n||r.length!==n);t=!0);}catch(e){a=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(a)throw o}}return r}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return sliceIterator(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(0),i=r(14),s=r(4),u=r(2),c=r(6);e.exports=shapeWalker},function(e,n,r){"use strict";function wallWalker(e,n){function wallWalk(r,a){var o=t(e.exprs,1),i=o[0];return n(i,r,a)}return{trailblaze:wallWalk,reconstruct:wallWalk}}var t=function(){function sliceIterator(e,n){var r=[],t=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done)&&(r.push(i.value),!n||r.length!==n);t=!0);}catch(e){a=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(a)throw o}}return r}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return sliceIterator(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.exports=wallWalker},function(e,n){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},,function(e,n,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toArray(e){return Array.isArray(e)?e:Array.from(e)}function AltHeadNode(e,n,r){this.label=e,this.clause=n,this.enclosed=r}function _strFragments(e,n,r){var t=[];e&&(t=t.concat([e,": "]));var o=_handler(n),i=o.head,u=o.params;if(!i)return[];if(r){var c=r(i);if(c)return t.concat(c)}if("PRED"===i.type)return[""+C(i.opts.predicate)];(0,s.humanReadable)(i);if("FCLAUSE"===i.type){var l=a(u.unlabelled,1),f=l[0].item.unquotedParamsMap,p=f.args;p=void 0===p?{}:p;var d=p.singleParam,m=f.ret;m=void 0===m?{}:m;var v=m.singleParam;return[].concat(d?_fragmentParamAlts(null,d,r):[]).concat([" → "]).concat(v?_fragmentParamAlts(null,v,r):["any"])}if("CAT"===i.type){var g=u.labelled,y=u.unlabelled,_=[];if(g){var h=g.reduce(function(e,n){var t=n.label,a=n.item,o=_processLabel(t);return e.concat([[_fragmentParamAlts(o,a,r)]])},[]);_=(0,s.interpose)(h,[", ",s.NEW_LINE])}else if(y){var b=y.map(function(e){var n=e.item;return _fragmentParamAlts(null,n,r)});_=(0,s.interpose)(b,[", ",s.NEW_LINE])}return t.concat(["( "]).concat(_).concat([" )"])}if("OR"===i.type){var x=u.labelled,O=u.unlabelled,w=[];if(x){var P=x.reduce(function(e,n){var t=n.item;return e.concat([[_fragmentParamAlts(null,t,r)]])},[]);w=(0,s.interpose)(P,[" | ",s.NEW_LINE])}else if(O){var E=O.map(function(e){var n=e.item;return _fragmentParamAlts(null,n,r)});w=(0,s.interpose)(E,[" | ",s.NEW_LINE])}return t.concat(["{ "]).concat(w).concat([" }"])}if("Z_OR_M"===i.type){var S=a(u.unlabelled,1),R=S[0].item,N=_fragmentParamAlts(null,R,r);return["( "].concat(t).concat([N," )*"])}if("O_OR_M"===i.type){var k=a(u.unlabelled,1),F=k[0].item,M=_fragmentParamAlts(null,F,r);return["( "].concat(t).concat([M," )+"])}if("Z_OR_O"===i.type){var j=a(u.unlabelled,1),T=j[0].item,q=_fragmentParamAlts(null,T,r);return["( "].concat(t).concat([q," )?"])}if("COLL_OF"===i.type){var D=a(u.unlabelled,1),L=D[0].item,I=_fragmentParamAlts(null,L,r);return["[ "].concat(t).concat([I," ]*"])}if("ANY"===i.type)return t.concat(["any"]);if("SHAPE"===i.type){var W=(u.unlabelled[0].item.unquotedParamsMap,a(u.unlabelled,1)),z=W[0].item.unquotedParamsMap,U=z.required;U=void 0===U?{singleParam:{}}:U;var G=U.singleParam.quotedParamsMap,V=z.optional;V=void 0===V?{singleParam:{}}:V;var Z=V.singleParam.quotedParamsMap,K=[];if(G)for(var H in G){var Q=A(G[H],{keyList:function(e){return["[ "].concat((0,s.interpose)(e.map(function(e){return'"'+e+'"'}),[", "])).concat(" ]")},singleParam:function(e){return _fragmentParamAlts(null,e,r)}},function(){throw"!e"});Q&&(K=K.concat([[H+"*: ",Q]]))}if(Z)for(var Y in Z){var $=A(Z[Y],{keyList:function(e){return["[ "].concat((0,s.interpose)(e.map(function(e){return'"'+e+'"'}),[", "])).concat(" ]")},singleParam:function(e){return _fragmentParamAlts(null,e,r)}},function(){throw"!e"});$&&(K=K.concat([[Y+"?: ",$]]))}var B=(0,s.interpose)(K,[", "]);return t.concat(["{ "]).concat(B).concat([" }"])}if("AND"===i.type)return _fragmentParamAlts(e,u.unlabelled[0].item,r);if("MAP_OF"===i.type){var J=a(u.unlabelled,1),X=J[0].item.unquotedParamsMap,ee=X.key.singleParam,ne=X.val.singleParam,re=[].concat(_fragmentParamAlts(null,ee,r)).concat([", "]).concat(_fragmentParamAlts(null,ne,r));return t.concat(["< "]).concat(re).concat([" >"])}throw console.error(i),"not supported"}function _processLabel(e){var n=e.str,r=e.quoted;return n?n:r?r.value:void 0}function _fragmentParamAlts(e,n,r){var t=A(n,{label:_processLabel,sExpression:function(n){return _strFragments(e,n,r)},quotedParamsMap:function(e){return _fragmentParamsObj(e,r,!1)},unquotedParamsMap:function(e){return _fragmentParamsObj(e,r,!1)},optionsObj:function(e){return S(e)},recursive:function(e){var n=e.expression;return["<recursive>: ",(0,s.humanReadable)(n)]}},function(e){throw console.error(e),"!s"});return t}function _fragmentParamsObj(e,n){var r=["< ",s.INDENT_IN,s.NEW_LINE],t=[],a=e.key,o=e.val,i=A(a,{keyList:function(e){return["[ "].concat((0,s.interpose)(e.map(function(e){return'"'+e+'"'}),[", "])).concat(" ]")},singleParam:function(e){return _fragmentParamAlts(null,e,n)}},function(){throw"!e"}),u=A(o,{keyList:function(e){return["[ "].concat((0,s.interpose)(e.map(function(e){return'"'+e+'"'}),[", "])).concat(" ]")},singleParam:function(e){return _fragmentParamAlts(null,e,n)}},function(){throw"!e"});return t.push([i]),t.push([u]),t=(0,s.interpose)(t,[", ",s.NEW_LINE]),r=r.concat(t).concat([s.INDENT_OUT,s.NEW_LINE," >"])}function _describeCase(e,n){var r=x(k,e);if(w.isProblem(r))throw"!!";var t=_strFragments(null,r,n),a=(0,s.fragsToStr)(t,0,0);return a}function _handler(e){var n=e.head,r=e.params;return A(n,{expression:function(e){return{head:E(e),params:r}},altNode:function(e){var n=e.enclosed;return A(n,{sExpression:_handler},function(){})}},function(){throw"3"})}function _expand(e,n){if(w.isValid(k,e)){var r=_toArray(e),i=r[0],s=r.slice(1);if(i===n){var u=_makeAlts(i,s);return{found:!0,cases:u}}for(var c=function(r){var t=_expand(s[r],n),a=t.found,o=t.cases;if(a)return{v:{found:a,cases:o.map(function(n){return _makeAltCase(n,e,r)})}}},l=0;l<s.length;l+=1){var f=c(l);if("object"===("undefined"==typeof f?"undefined":t(f)))return f.v}}if(e[0]instanceof AltHeadNode){var p=function(){for(var r=a(e,1),o=r[0],i=o.enclosed,s=o.label,u=o.clause,c=function(e){var r=_expand(i[e],n),t=r.found,a=r.cases;if(t)return{v:{v:{found:t,cases:a.map(function(n){return[new AltHeadNode(s,u,_makeAltCase(n,i,e-1))]})}}}},l=0;l<i.length;l+=1){var f=c(l);if("object"===("undefined"==typeof f?"undefined":t(f)))return f.v}}();if("object"===("undefined"==typeof p?"undefined":t(p)))return p.v}if(e instanceof o.QuotedParamsMap||e instanceof o.UnquotedParamsMap){var d=function(r){if(e.hasOwnProperty(r)){var t=e[r],a=_expand(t,n),o=a.found,i=a.cases;if(o)return{v:{found:o,cases:i.map(function(n){return _makeAltCaseMap(n,e,r)})}}}};for(var m in e){var v=d(m);if("object"===("undefined"==typeof v?"undefined":t(v)))return v.v}}return{found:!1,cases:[e]}}function _makeAlts(e,n){return e.opts.named?e.exprs.map(function(r,t){var a=r.name;r.expr;return[new AltHeadNode(a,e,n[2*t+1])]}):e.exprs.map(function(r,t){return[new AltHeadNode(null,e,n[t])]})}function _makeAltCase(e,n,r){return n.slice(0,r+1).concat([e]).concat(n.slice(r+2))}function _makeAltCaseMap(e,n,r){var t=void 0;return n instanceof o.QuotedParamsMap?t=new o.QuotedParamsMap:n instanceof o.UnquotedParamsMap&&(t=new o.UnquotedParamsMap),P(t,n),t[r]=e,t}function _fold(e,n,r,a,o){var i=n.sExpression,s=n.quotedParamsMap,u=n.unquotedParamsMap,c=r;if(i){var l,f=function(){var n=i.head,r=i.params;r=void 0===r?{}:r;var t=r.labelled,o=r.unlabelled,s=E(n);if(a&&(l=a(s)))return{v:c};c=e(c,s);var u=t||o||[];c=u.reduce(function(n,r){var t=r.item;return"FCLAUSE"===s.type?_fold(e,t,n,a,!0):_fold(e,t,n,a)},c)}();if("object"===("undefined"==typeof f?"undefined":t(f)))return f.v}else if(s||u){var p=s||u;for(var d in p)if(p.hasOwnProperty(d)&&(!o||!u||"ret"!==d)){var m=p[d].singleParam;m&&(c=_fold(e,m,c,a,o))}}return c}function _findPivots(e,n){return _fold(function(e,n){return _isPivot(n)&&e.indexOf(n)<0?e.concat([n]):e},e,[],n)}function _isPivot(e){return"OR"===e.type}Object.defineProperty(n,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function sliceIterator(e,n){var r=[],t=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done)&&(r.push(i.value),!n||r.length!==n);t=!0);}catch(e){a=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(a)throw o}}return r}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return sliceIterator(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=r(28),i=_interopRequireDefault(o),s=r(30),u=r(11),c=u.cat,l=u.or,f=(u.shape,u.zeroOrOne),p=u.maybe,d=(u.oneOrMore,u.fclause),m=(u.any,u.and),v=(u.wall,u.ExprClause),g=(u.collOf,r(12)),y=(g.isStr,g.isFn),_=(g.isNum,g.isInt),h=(g.isObj,g.isBool,g.instanceOf),b=r(18),x=b.conform,O=(b.isClause,b.deref,b.delayed),w=r(44),P=r(4),E=r(6),C=r(3),S=r(20),A=r(19),R=(0,o.genClauses)(l("expression",v,"altNode",m(h(AltHeadNode),w.shape({required:{clause:_isPivot,enclosed:O(function(){return F})}})))),N=a(R,2),k=N[0],F=N[1],M=d({args:c(v,f(_),f(p(y)))}).instrument(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,r=arguments[2],t=(0,i.default)(e),a=x(o.ParamItemClause,t),s=_findPivots(a,r),u=s.reduce(function(e,r){var t=e.reduce(function(e,t){if(e.length>n)return e;var a=_expand(t,r),o=a.cases;return e.concat(o)},[]);return t},[t]),c=u.map(function(e){return _describeCase(e,r)});return c});n.default=M},,function(e,n,r){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function gen(e){var n=a.NamespaceObjClause.conform(e),r=_walk(e,null,null,n);return r}function genCot(e){var n=(0,y.getDefList)(e),r=Object.keys(n);return"<dl>\n    "+r.map(function(r){return"\n    <dt>\n      "+r+"\n    </dt>\n    <dd>\n      <ul>\n      "+n[r].map(function(n){var r=t(n,3),a=r[0],i=r[1],s=r[2];return"<li>\n            "+_clauseRefLink(a+"/"+i)(function(n){return _stylizeName((0,g.default)(s),_getAlias(e,n)||_unanbiguousName(n),(0,o.getMeta)(n,e))})+"\n          </li>"}).join("")+"\n      </ul>\n    </dd>\n    "}).join("")+"\n  </dl>"}function _getAlias(e,n){var r=(0,o.getMeta)(n,e);return r&&r.name}function _walk(e,n,r,t){var a=n?n+"."+r:r,o="",i=[],s=void 0,u=void 0,c=void 0;for(var l in t)if(t.hasOwnProperty(l))switch(l){case"subNamespaces":c=t[l];for(var f in c)if(c.hasOwnProperty(f)){var p=_walk(e,a,f,c[f]);i.push(p)}break;case".nsComment":s="<p><i>"+t[l]+"</i></p>";break;case".expr":u=_exprMeta(e,r,t[".expr"],t[".meta"]);
}return u&&(o+=u),a&&(s||_hasExprs(c))&&(o+="<h3>"+a+"/</h3><hr />"),s&&(o+=s),i.length>0&&(o+=i.join("\n")),o}function _hasExprs(e){return!!e&&Object.keys(e).filter(function(n){return e[n][".expr"]}).length>0}function _exprMeta(e,n,r,t){if(!r)throw new Error("Expression "+n+" does not exist in the registry");var a=void 0;return a=genForExpression(e,n,r,t)}function _stylizeName(e,n,r){return"FCLAUSE"===e.type&&n[0]===n[0].toLowerCase()||r&&r.showAsFunction?n+"()":n}function _type(e){return(0,f.default)(e)?x[e.type]||e.type.toLowerCase():(0,c.default)(e)?"predicate":void 0}function genForExpression(e,n,r,t){var a=void 0,o=(0,y.resolve)(r,e);if(o&&!n)a=_genClauseRef(e,n,o,r,t);else if("CLAUSE_REF"===r.type)a=_genClauseRef(e,n,null,r,t);else{if("DELAYED"===r.type)return genForExpression(e,n,r.get(),t);a="FCLAUSE"===r.type?_genFclause(e,n,r,o,t):"OR"===r.type?_genOrClause(e,n,o,r,t):"CAT"===r.type?_genCatClause(e,n,o,r,t):(0,c.default)(r)||"PRED"===r.type?_genPredClause(e,n,r,t):(0,c.default)(r)||"ANY"===r.type?_genAnyClause():"AND"===r.type?_genAndClause(e,n,o,r,t):_genUnknownClause(e,n,o,r,t)}var i=t&&t.name||n,s=n&&o?"\n      <h6>"+_stylizeName(r,i)+'</h6>&nbsp;\n        <span class="tag tag-primary">\n          '+_type(r)+"\n        </span>\n      ":null;return"\n    "+(n&&o?'<a name="'+o+'"></a>':"")+"\n    "+_wrapCard({header:s,legend:o?'<span class="tag tag-info">[clause]</span>':_tagFor(r,e,o),borderlabel:_labelFor(r)})(a)}function _wrapCard(e){var n=e.header,r=e.legend,t=e.borderlabel;return n?function(e){return'\n        <div class="card">\n          <div class="card-header inline-headers">\n            '+n+"\n          </div>\n        "+e+"\n        </div>\n      "}:r?function(e){return'\n    <fieldset class="card card-outline-'+(t||"default")+'">\n    <legend class="clause-type">\n      '+r+"\n    </legend>\n    "+e+"\n    </fieldset>\n    "}:void 0}function escapeHtml(e){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return n[e]})}function _tagFor(e,n,r){return'\n    <span \n      role="button"\n      data-toggle="popover"\n      data-trigger="focus hover"\n      data-html="true"\n      data-content="'+escapeHtml(_description(e,n,r))+'"\n      data-container="body"\n      data-animation="false"\n      data-delay="500"\n      class="tag tag-'+_labelFor(e)+'">\n      '+_typeFor(e)+"\n    </span>\n  "}function _rawTypeFor(e){var n=void 0,r=(0,g.default)(e);return n=(0,c.default)(r)?"pred":r.type.toLowerCase()}function _typeFor(e){var n=_rawTypeFor(e);switch(n){case"pred":return"[pred] satisfies predicate";case"fclause":return"[fclause] a function";case"z_or_m":return"[*] zero or more";case"o_or_m":return"[+] one or more";case"z_or_o":return"[?] optional";case"coll_of":return"[collOf] a collection of";case"cat":return"[cat] a sequence of";case"or":return"[or] either one of";default:return'<span class="tag tag-info">['+n+"]</span>"}}function _labelFor(e){var n=_rawTypeFor(e);switch(n){case"pred":return"primary";case"fclause":return"info";case"cat":case"or":return"info";default:return"info"}}function _genAnyClause(){return'\n    <div class="card-block">Any value.</div>\n  '}function _genClauseRef(e,n,r,t,a){var o=r||t.ref;return'\n    <div class="card-block">\n      A value of type\n      '+_clauseRefLink(o)(function(e){return e})+"\n    </div>\n  "}function _genAndClause(e,n,r,t,a){var o=(a&&a.example,t.opts.conformedExprs.map(function(n,r){return'\n        <fieldset class="list-group-item card-outline-'+_labelFor(t)+'">\n          <legend class="clause-type">\n            <span class="tag tag-default">Condition '+(r+1)+' </span>\n          </legend>\n          <div class="row">\n            <div class="col-md-12">\n              '+genForExpression(e,null,b(n),null)+"\n            </div>\n          </div>\n        </fieldset>\n    "})),i='\n    <div class="card-block">\n      <p class="card-title">\n        Should satisfy <em>all</em> of the following expression:\n      </p>\n    </div>\n    <div class="list-group list-group-flush list-for-cat">\n      '+o.join(" ")+"\n    </div>\n  ";return i}function _genCatClause(e,n,r,t,a){var o=(a&&a.example,t.exprs.map(function(n,r){var o=n.name,i=n.expr,s=a&&a[o]&&a[o].comment;return'\n        <fieldset class="list-group-item card card-outline-'+_labelFor(t)+'">\n          <legend class="clause-type">\n          '+(o?'\n            <span class="tag tag-default">Part '+(r+1)+'</span>\n            <span class="lead font-italic text-primary">\n              &ldquo;'+o+"&rdquo;</span>          \n          ":'<span class="tag tag-default">Part '+(r+1)+"</span>")+'\n          </legend>\n          <div class="row">\n            <div class="col-md-12">\n              '+(s?"<span>"+s+"</span>":"")+'\n            </div>\n          </div>\n          <div class="row">\n            <div class="col-md-12">\n              '+genForExpression(e,null,i,a&&a[o])+"\n            </div>\n          </div>\n        </fieldset>\n    "})),i='\n    <div class="card-block">\n      <p class="card-title">\n        Should be <em>an ordered list</em> of the following:\n      </p>\n    </div>\n    <div class="list-group list-group-flush list-for-cat">\n      '+o.join(" ")+"\n    </div>\n  ";return i}function _clauseRefLink(e){return function(n){return'<a href="#'+e+'" data-path="'+e+'">'+n(e)+"</a>"}}function _description(e,n,r){return'\n    <pre class="clause-description"><code class="clause">'+unescape(_encode((0,m.default)(e,_refExprFn(n,r),2)))+"</code></pre>\n  "}function _encode(e){return e.split("<").join("&lt;").split(">").join("&gt;")}function _refExprFn(e,n){return function(r){var t=(0,y.resolve)(r,e);if(t&&t!==n){var a=_clauseRefLink(t)(_unanbiguousName);return a=escape(a),[a]}return null}}function _unanbiguousName(e){var n=e.substring(e.indexOf("/")+1);return n}function _genPredClause(e,n,r,t){var a=r.exprs?r.exprs[0]:r,o='\n    <div class="card-block">\n      '+_predSourcePopover("A value that satisfies ",a)+"\n    </div>\n  ";return o}function _predSourcePopover(e,n){var r=(0,s.default)(n);return"\n    <em>\n      "+e+'\n      <span\n        data-toggle="popover"\n        data-trigger="hover click"\n        data-html="true"\n        role="button"\n        data-placement="top"\n        data-content="<pre>'+n.toString()+'</pre>"\n        data-container="body"\n        data-animation="false"\n        data-delay="500">\n        '+r+"()\n      </span>\n    </em>\n  "}function _genUnknownClause(e,n,r,t,a){var o='\n    <div class="card-block">\n      '+t.exprs.map(function(n){var r=n.name,t=n.expr;return t?genForExpression(e,r,t,a&&a[r]):genForExpression(e,null,n,null)}).join("")+"\n    </div>\n  ";return o}function _genOrClause(e,n,r,t,a){a||(a={});var o=t.exprs.map(function(n,r){var o=n.name,i=n.expr,s=a[o]&&a[o].comment,u=a[o]&&a[o].examples;return(0,p.isStr)(u)&&(u=[u]),'\n        <fieldset class="list-group-item card-outline-'+_labelFor(t)+'">\n          <legend class="clause-type">\n            <span class="tag tag-default">\n                Option '+(r+1)+"\n            </span>\n            "+(o?'\n                <span class="lead font-italic text-primary">\n                  &ldquo;'+o+"&rdquo;\n                </span>\n            ":"")+'\n          </legend>\n          <div class="row">\n            <div class="col-md-12">\n            '+(s?"<div>"+s+"</div>":"")+"\n            \n            "+(u?'\n              <h6>Examples: </h6>\n                <div class="code-examples">\n                  '+u.map(function(e){return"\n                    <pre><code>"+e.trim()+"</code></pre>\n                  "}).join("\n")+"\n                </div>\n            ":"")+'\n            </div>\n          </div>\n          <div class="row">\n            <div class="col-md-12">\n              '+genForExpression(e,null,i,a&&a[o])+"\n            </div>\n          </div>\n        </fieldset>\n    "}),i='\n    <div class="card-block">\n      <p class="card-title">\n      '+(n?"":"\n      ")+'\n        Should be <em>one of</em> the following:\n      </p>\n    </div>\n    <div class="list-group list-group-flush list-for-or">\n      '+o.join("")+"\n    </div>\n  ";return i}function _genFclause(e,n,r,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=[],u=o||{},c=u.comment,l=u.examples;(0,p.isStr)(l)&&(l=[l]);var f=r.opts,d=f.args,m=f.ret,v=f.fn;c&&i.push([null,c]),d&&i.push(["Syntax","<ul>\n        "+(0,h.default)(r,20,_refExprFn(e,a)).map(function(e){return"<li>"+unescape(_encode(e))+"</li>"}).join("")+"\n      </ul>"]),l&&i.push(['Examples  <button class="btn btn-info btn-sm launch-code-examples" data-name="'+n+'">\n          Live Eval\n        </button>','\n      <div class="code-examples" data-name="'+n+'">\n        '+l.map(function(e){return"\n            <pre><code>"+e.trim()+"</code></pre>\n          "}).join("")+"\n      </div>\n    "]),n&&a&&i.push(["Clause Description",'\n    <blockquote class="blockquote">\n      <small>\n        <em class="text-muted">\n          '+_description(r,e,a)+"\n        </em>\n      </small>\n    </blockquote>\n  "]),d&&i.push(["Argument Clause Graph",_wrapWithCollapsible(n+"-args-graph",genForExpression(e,null,d,o&&o.args))]),m&&i.push(["Return Value Clause Graph",_wrapWithCollapsible(n+"-ret-graph",genForExpression(e,null,m,o&&o.ret))]),v&&i.push(["Argument-return value relation","<pre>"+(0,s.default)(v)+"</pre>"]);var g='\n    <dl class="card-block">\n    '+i.map(function(e){var n=t(e,2),r=n[0],a=n[1],o=r?"<dt>"+r+"</dt>":"",i="<dd>"+a+"</dd>";return""+o+i}).join("\n")+"\n    </dl>\n  ";return g}function _wrapWithCollapsible(e,n){return'<p>\n     <button class="btn btn-sm btn-info" type="button" data-toggle="collapse" data-target="#'+e+'" aria-expanded="false" aria-controls="collapseExample">\n      Show Graph »\n    </button>\n  </p>\n  <div class="collapse" id="'+e+'">\n    '+n+"\n  </div>\n"}var t=function(){function sliceIterator(e,n){var r=[],t=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(t=(i=s.next()).done)&&(r.push(i.value),!n||r.length!==n);t=!0);}catch(e){a=!0,o=e}finally{try{!t&&s.return&&s.return()}finally{if(a)throw o}}return r}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return sliceIterator(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=r(27),o=r(31),i=r(3),s=_interopRequireDefault(i),u=r(10),c=_interopRequireDefault(u),l=r(5),f=_interopRequireDefault(l),p=r(12),d=r(30),m=_interopRequireDefault(d),v=r(29),g=_interopRequireDefault(v),y=r(43),_=r(85),h=_interopRequireDefault(_),b=r(6),x={FCLAUSE:"function",PRED:"predicate",CAT:"cat sequence"},O={gen:gen,genForExpression:genForExpression,genCot:genCot,syntax:h.default};e.exports=O,e.exports.default=O}])});